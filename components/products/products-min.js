function addSpace(){document.querySelector(".shopping-cart").classList.contains("is-hidden")?document.body.style.cssText="margin-bottom: 0;":document.querySelector("body").style.cssText="margin-bottom: "+document.querySelector(".shopping-cart").offsetHeight+"px;"}function loadCart(){html="",shoppingCart.products.forEach(function(t){html+='<tr class="shopping-cart__item" data-item-id='+t.id+" >",html+='<td class="shopping-cart__item-title">'+t.name+"</td>",html+='<td class="shopping-cart__item-price">'+t.price+"</td>",html+='<td class="shopping-cart__item-quantity"><span class="js-quantity">'+t.quantity+'</span><input type="text" name="" class="shopping-cart__item-quantity-edit js-quantityInput is-hidden" value="'+t.quantity+'"><i class="material-icons js-confirmChange is-hidden">check_circle</i><i class="material-icons js-edit-quantity shopping-cart__edit-button" data-item-id='+t.id+" >mode_edit</i></td>",html+='<td class="shopping-cart__item-total">'+money(t.price*t.quantity)+"</td>",html+="<td data-item-id="+t.id+' class="shopping-cart__delete-button js-delete-cart-item"><i class="material-icons">close</i></td>',html+="</tr>"}),document.querySelector(".shopping-cart__body").innerHTML=html,document.querySelectorAll(".js-delete-cart-item").forEach(function(t){t.addEventListener("click",function(){deleteItemFromCart(this)})}),document.querySelectorAll(".js-edit-quantity").forEach(function(t){t.addEventListener("click",function(){var t=this.parentElement;t.querySelector(".shopping-cart__item-quantity-edit").classList.toggle("is-hidden"),t.querySelector(".js-confirmChange").classList.toggle("is-hidden"),t.querySelector(".js-edit-quantity").classList.toggle("is-hidden"),t.querySelector(".js-quantity").classList.toggle("is-hidden")})}),document.querySelectorAll(".js-confirmChange").forEach(function(t){t.addEventListener("click",function(){var t=closest(this,"shopping-cart__item");if(t.querySelector(".js-quantityInput").value!=t.querySelector(".js-quantity").innerHTML){var e=t.querySelector(".js-quantityInput").value;if(0==e)deleteItemFromCart(closest(this,"shopping-cart__item"));else{e>999&&(e=999);var o=t.dataset.itemId;updateQuantity(parseInt(o),parseInt(e)),updateCartAmount(),loadCart(),updateTotal(),addSpace()}}t.querySelector(".js-quantityInput").classList.toggle("is-hidden"),t.querySelector(".js-confirmChange").classList.toggle("is-hidden"),t.querySelector(".js-edit-quantity").classList.toggle("is-hidden"),t.querySelector(".js-quantity").classList.toggle("is-hidden")})})}function hasClass(t,e){var o=" "+t.className+" ",n=" "+e+" ";return-1!=o.indexOf(n)}function closest(t,e){for(;t&&t!==document;){if(hasClass(t,e))return t;t=t.parentNode}return null}function updateQuantity(t,e){findObjectByKey(shoppingCart.products,"id",t).quantity=e}function loadProducts(){var t="";products.forEach(function(e){t+="",t+='<section class="product">',t+='<img class="product__image" src="http://placehold.it/200x200">',t+='<p class="product__rating">',t+='<i class="product__rating-star material-icons">star_border</i>',t+='<i class="product__rating-star material-icons">star_border</i>',t+='<i class="product__rating-star material-icons">star_border</i>',t+='<i class="product__rating-star material-icons">star_border</i>',t+='<i class="product__rating-star material-icons">star_border</i>',t+="</p>",t+='<p class="product__name">'+e.name+"</p>",t+='<p class="product__price">'+e.price+"</p>",t+='<button data-pid="'+e.id+'" class="product__add-to-cart"><i class="product__cart-icon material-icons">shopping_basket</i>ADD TO CART</button>',t+="</section>"}),document.querySelector(".products").innerHTML=t,addToCartFunction()}function addToCartFunction(){document.querySelectorAll(".product__add-to-cart").forEach(function(t){t.addEventListener("click",function(){addProduct(this),updateCartAmount(),loadCart(),updateTotal(),addSpace()})})}function deleteItemFromCart(t){var e=parseInt(t.dataset.itemId),o=findObjectByKey(shoppingCart.products,"id",e);delete shoppingCart.products[shoppingCart.products.indexOf(o)],shoppingCart.products=shoppingCart.products.filter(function(t){return void 0!=t}),updateCartAmount(),loadCart(),updateTotal(),addSpace()}function addProduct(t){var e=parseInt(t.dataset.pid),o=findObjectByKey(products,"id",e),n=findObjectByKey(shoppingCart.products,"id",e);n?n.quantity+=1:(o.quantity=1,shoppingCart.products.push(o))}function updateTotal(){document.querySelector(".js-total").innerHTML=shoppingCart.subtotal()}function findObjectByKey(t,e,o){for(var n=0;n<t.length;n++)if(t[n][e]===o)return t[n];return null}function updateCartAmount(){document.querySelectorAll(".js-cart-amount").forEach(function(t){t.innerHTML=shoppingCart.totalItems()})}document.addEventListener("DOMContentLoaded",function(){document.querySelector(".top-header__menu-button").addEventListener("click",function(){document.querySelector(".top-header__mobile-menu").classList.toggle("is-hidden")}),document.querySelector(".top-header__mobile-menu-close").addEventListener("click",function(){document.querySelector(".top-header__mobile-menu").classList.toggle("is-hidden")}),document.querySelector(".top-header__cart-button").addEventListener("click",function(){document.querySelector(".shopping-cart").classList.toggle("is-hidden"),addSpace()}),document.querySelector(".js-cart-close").addEventListener("click",function(){document.querySelector(".shopping-cart").classList.toggle("is-hidden"),addSpace()}),document.querySelector(".js-cart").addEventListener("click",function(){document.querySelector(".shopping-cart").classList.toggle("is-hidden"),addSpace()}),document.querySelector(".js-coupon-submit").addEventListener("click",function(){var t=document.querySelector(".js-coupon-input").value,e=findObjectByKey(discountCodes,"code",t);0===t.length?console.log("nothing in the input field dummy"):e?e.run():console.log("Coupon does not exist")})}),money=function(t){return t.toFixed(2)},shoppingCart={products:[],discount:{currentCouponActive:!1,currentCouponAffects:[],currentCouponType:"",currentCouponAmount:"",currentTotalDiscount:""},totalItems:function(){var t=0;return this.products.forEach(function(e){t+=e.quantity}),t},subtotal:function(){var t=0;return this.products.forEach(function(e){var o=e.quantity,n=e.price;console.log(shoppingCart.discount.currentCouponAffects.indexOf(e.id)),t+=o*n}),money(t)},total:function(){var t=this.subtotal(),e=20,o=.0675,n=.0675*t,i=t+n+20;return Number(i)}},processDiscount={perItem:function(t,e){console.log(t+" - product numerbs to be discounted"),console.log(e+" - discount to be discounted"),shoppingCart.discount.currentCouponActive?console.log("UPDATED!"):(shoppingCart.discount.currentCouponType="perItem",shoppingCart.discount.currentCouponAffects=[t],shoppingCart.discount.currentCouponAmount=e,updateCartAmount(),loadCart(),updateTotal())},perType:function(t,e){console.log(t+" - categories to be discounted"),console.log(e+" - amount to be discount")},total:function(t){console.log(t+" - amount to be discounted")},freeShip:function(){console.log("the shipping will be marked off")}},discountCodes=[{code:"20offlawnmower",run:function(){processDiscount.perItem(7,20)}},{code:"15offcateg1",run:function(){processDiscount.perType(["categ1"],15)}},{code:"10offtotal",run:function(){processDiscount.total(10)}},{code:"freeShip",run:function(){processDiscount.freeShip()}}],loadProducts();